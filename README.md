# Gary ROS2控制方案

Gary ROS2是一套运行在 PC 上运行的无下位机、视控一体软件和配套硬件，基于 ROS2 和 ROS2-Control的硬件和仿真接口以及配套的控制器，用于开发高性能机器人。

## 基于ROS2
ROS是一种流行的机器人操作系统，它可以根据用户需要进行自由组合和定制，具有高度可配置性的特点。同时，ROS支持多种操作系统，包括Linux、Windows、Mac OS等，实现了跨平台使用。ROS提供了丰富的工具和API接口，使得用户可以方便地将现有的软件集成到ROS中并进行扩展。此外，ROS还拥有大量的开源库和工具，可以帮助用户快速实现机器人应用开发，加快机器人系统的开发和创新。因此，使用ROS可以更加方便地进行机器人应用开发，实现机器人系统的快速开发和创新。ROS 2 相比于 ROS 1 具有更高的可靠性、支持多平台、更好的实时性、易于扩展和更好的安全性。它使用 DDS 中间件来进行消息传递，可以在低延迟和高吞吐量的情况下提供更可靠的数据交换。同时，ROS 2 采用了新的构建工具和依赖管理系统，支持多个操作系统和嵌入式设备，更适合于大规模系统和多机器人协作的应用场景，并有助于提高机器人系统的可靠性、安全性和实时性要求。

## 无下位机控制
相比下位机控制，无下位机控制具有更低的硬件成本，简化的系统架构，更高的计算性能和响应速度，并且具有更强的灵活性和易于集成的特点。无下位机控制可以在一个计算机上执行所有的控制和计算任务，从而节省了硬件成本和简化了系统架构。采用高性能的计算机可以提供更快的计算和响应速度，从而提高系统的实时性和响应速度。此外，无下位机控制采用基于计算机的控制方式，具有很强的灵活性和易于集成的特点，便于实现不同的控制算法和应用。因此，无下位机控制在机器人应用领域有广泛的应用前景。

## 极高的代码复用率
我们在设计代码架构时,极其注重代码复用性,将代码模块化并参数化,对于不同机器人只需要根据配置文件加载不同数量和种类的控制器。做到了一套代码给所有机器人同时使用,如:在开发好机器人的基础模块后,开发相同功能的其他机器人时,只需要编写配置文件,除了决策层的开发,不需要书写或修改任何一行代码。我们在全部机器人中都使用了gary_ros2, 取得了良好的效果。

## 多刚体动力学仿真
多刚体力学仿真在机器人上的优势在于可以对机器人进行高精度的动力学分析和控制，从而提高机器人的运动稳定性和响应能力。通过多刚体力学仿真，可以预测机器人在不同情况下的运动状态和能耗，优化机器人的控制算法、机械设计和电气系统，提高机器人的工作效率和能力。在机器人的研发、生产和应用过程中，多刚体力学仿真可以降低成本和风险，缩短开发周期，提高机器人的适应性和可靠性，促进机器人技术的发展和应用。队伍中所有机器人都能在Gazebo进行多刚体动力学仿真，且仿真和实际运行的代码不需要相互移植，是同一份代码甚至同一个二进制文件。除了发射控制器，其他模块和控制器在开发时均会在仿真中调试和测试，打断点时可以做到时间暂停，在机械还没有加工装配完成时已经可以把代码测试好，完成参数的粗调，大大提高开发和迭代效率。

## 良好的兼容性
使用Linux的SocketCAN可以直接访问CAN总线，方便了嵌入式CAN设备的开发和测试，而且支持标准的CAN和CAN FD协议。SocketCAN提供了高性能的Socket接口和多种编程语言的API，方便开发人员进行CAN数据的读写和处理。同时，SocketCAN还支持CAN总线的过滤和监听功能，可以方便地监控CAN总线上的数据流，对CAN数据进行分析和调试。使用SocketCAN可以实现快速、准确的CAN通信，提高嵌入式系统的稳定性和可靠性。硬件接口基于Linux的SocketCAN和sysfs，意味着可以在带有CAN接口的嵌入式开发板上运行，同时我们还制作了usb转CAN设备，从而支持在任意PC平台上面运行，如：Intel NUC和笔记本电脑。

## 丰富的调试工具
在ROS中，调试工具是非常重要的部分，它们可以帮助开发者找出程序中的问题，提高开发效率和可靠性。 首先，ROS调试工具具有实时性的优势。这意味着它们可以随时接受数据流并提供实时反馈，帮助开发者快速定位问题。例如，ROS自带的“ros2 topic echo”命令可以实时查询指定的ROS主题（Topic）并显示其消息内容。 其次，ROS调试工具具有可视化的优势。ROS中有许多可视化工具，例如Rviz、rqt等等，它们可以帮助开发者以图形化的方式查看机器人的状态、传感器数据、执行路径等等。使用这些工具，开发者可以更直观地了解机器人的运行情况，快速发现问题。 最后，ROS调试工具具有集成性的优势。ROS相当于是一个生态系统，拥有众多的节点、包、库等等，这些工具往往都能方便地与其他ROS工具集成使用。例如，ROS自带的“rosbag”命令可以将机器人传感器数据保存下来，后续可与Rviz等工具集成使用，来可视化回放。 总之，ROS调试工具能够在机器人开发中起到至关重要的作用，通过实时性、可视化、集成性等优势，能够帮助开发者快速定位问题，解决问题，提高开发效率和可靠性。依托 ROS 生态，可以使用多种可视化调试工具，对电机数据，计算结果和图像远程查看。还可以使用 dynamic_reconﬁgure 进行动态调参。展示了我们搭建的调试界面，由 rqt 的支持，我们不需要编写代码就可以构建自己的调试图形界面。
